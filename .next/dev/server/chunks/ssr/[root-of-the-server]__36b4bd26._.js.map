{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/admin-dash/emails/new-booking-email.tsx"],"sourcesContent":["import {\r\n    Body,\r\n    Button,\r\n    Container,\r\n    Column,\r\n    Head,\r\n    Heading,\r\n    Hr,\r\n    Html,\r\n    Img,\r\n    Link,\r\n    Preview,\r\n    Row,\r\n    Section,\r\n    Text,\r\n} from \"@react-email/components\";\r\nimport * as React from \"react\";\r\n\r\ninterface BookingEmailProps {\r\n    name: string;\r\n    phone_number: string;\r\n    package_title: string;\r\n    date: string;\r\n    guests: number;\r\n    adults?: number;\r\n    children?: number;\r\n    total_price: number;\r\n    status: string;\r\n    notes?: string;\r\n}\r\n\r\nexport const BookingNotificationEmail = ({\r\n    name = \"Valued Guest\",\r\n    phone_number = \"\",\r\n    package_title = \"Unknown Package\",\r\n    date = new Date().toISOString(),\r\n    guests = 1,\r\n    adults = 1,\r\n    children = 0,\r\n    total_price = 0,\r\n    status = \"Pending\",\r\n    notes,\r\n}: BookingEmailProps) => {\r\n    // Safe Date Formatting\r\n    let formattedDate = date;\r\n    try {\r\n        const d = new Date(date);\r\n        if (!isNaN(d.getTime())) {\r\n            formattedDate = d.toLocaleDateString(\"en-US\", {\r\n                weekday: \"long\",\r\n                year: \"numeric\",\r\n                month: \"long\",\r\n                day: \"numeric\",\r\n            });\r\n        }\r\n    } catch (e) {\r\n        console.error(\"Date format error:\", e);\r\n    }\r\n\r\n    // Safe Price Formatting\r\n    let formattedPrice = `${total_price} MAD`;\r\n    try {\r\n        formattedPrice = new Intl.NumberFormat(\"en-MA\", {\r\n            style: \"currency\",\r\n            currency: \"MAD\",\r\n        }).format(total_price);\r\n    } catch (e) {\r\n        console.error(\"Price format error:\", e);\r\n    }\r\n\r\n    // Format phone for WhatsApp (remove spaces, +, etc)\r\n    const waPhone = phone_number ? phone_number.replace(/[^0-9]/g, \"\") : \"\";\r\n\r\n    // App URL (fallback to localhost if env not set)\r\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL || \"http://localhost:3000\";\r\n\r\n    return (\r\n        <Html>\r\n            <Head />\r\n            <Preview>New Booking: {name} - {package_title}</Preview>\r\n            <Body style={main}>\r\n                <Container style={container}>\r\n                    {/* Header */}\r\n                    <Section style={header}>\r\n                        <Heading style={brandTitle}>MARRAGAFAY</Heading>\r\n                        <Text style={subTitle}>New Booking Request</Text>\r\n                    </Section>\r\n\r\n                    {/* Main Booking Details */}\r\n                    <Section style={contentSection}>\r\n                        <Row>\r\n                            <Column style={columnStyle}>\r\n                                <Text style={label}>CUSTOMER</Text>\r\n                                <Heading as=\"h4\" style={value}>{name}</Heading>\r\n                                <Text style={infoText}>{phone_number || \"No phone provided\"}</Text>\r\n                            </Column>\r\n                            <Column style={columnStyle}>\r\n                                <Text style={label}>BOOKING</Text>\r\n                                <Heading as=\"h4\" style={value}>{package_title}</Heading>\r\n                                <Text style={infoText}>\r\n                                    {formattedDate} â€¢ {guests} Guests\r\n                                    {/* Optional chaining for adults/children just in case */}\r\n                                    <br />\r\n                                    <span style={subInfo}>({adults ?? 1} Adults, {children ?? 0} Kids)</span>\r\n                                </Text>\r\n                            </Column>\r\n                        </Row>\r\n\r\n                        <Hr style={divider} />\r\n\r\n                        <Row style={{ marginTop: \"20px\" }}>\r\n                            <Column>\r\n                                <Text style={label}>TOTAL PRICE</Text>\r\n                                <Heading as=\"h3\" style={priceValue}>{formattedPrice}</Heading>\r\n                            </Column>\r\n                            <Column>\r\n                                <Text style={label}>STATUS</Text>\r\n                                <Text style={statusBadge}>{status?.toUpperCase() || \"PENDING\"}</Text>\r\n                            </Column>\r\n                        </Row>\r\n\r\n                        {notes && (\r\n                            <Section style={{ marginTop: \"20px\", padding: \"15px\", backgroundColor: \"#fdf8f4\", borderRadius: \"8px\" }}>\r\n                                <Text style={{ ...label, marginBottom: \"5px\" }}>SPECIAL NOTES</Text>\r\n                                <Text style={noteText}>{notes}</Text>\r\n                            </Section>\r\n                        )}\r\n                    </Section>\r\n\r\n                    {/* Action Buttons */}\r\n                    <Section style={actionSection}>\r\n                        <Row>\r\n                            <Column align=\"center\" style={{ paddingRight: \"10px\" }}>\r\n                                <Button\r\n                                    style={primaryButton}\r\n                                    href={`tel:${phone_number}`}\r\n                                >\r\n                                    ðŸ“ž Call Customer\r\n                                </Button>\r\n                            </Column>\r\n                            <Column align=\"center\" style={{ paddingLeft: \"10px\" }}>\r\n                                <Button\r\n                                    style={secondaryButton}\r\n                                    href={`https://wa.me/${waPhone}`}\r\n                                >\r\n                                    ðŸ’¬ WhatsApp\r\n                                </Button>\r\n                            </Column>\r\n                        </Row>\r\n                        <Row style={{ marginTop: \"15px\" }}>\r\n                            <Column align=\"center\">\r\n                                <Link href={`${baseUrl}/dashboard/bookings`} style={dashboardLink}>\r\n                                    View in Dashboard â†’\r\n                                </Link>\r\n                            </Column>\r\n                        </Row>\r\n                    </Section>\r\n\r\n                    {/* Footer */}\r\n                    <Section style={footer}>\r\n                        <Text style={footerText}>\r\n                            Marragafay Travels<br />\r\n                            Marrakech, Morocco<br />\r\n                            <Link href=\"https://marragafay.com\" style={footerLink}>www.marragafay.com</Link>\r\n                        </Text>\r\n                        <Text style={footerSubText}>\r\n                            Â© {new Date().getFullYear()} Marragafay. All rights reserved.\r\n                        </Text>\r\n                    </Section>\r\n                </Container>\r\n            </Body>\r\n        </Html>\r\n    );\r\n};\r\n\r\nexport default BookingNotificationEmail;\r\n\r\n// --- Styles ---\r\n\r\nconst main = {\r\n    backgroundColor: \"#f5f5f5\",\r\n    fontFamily: '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Ubuntu,sans-serif',\r\n};\r\n\r\nconst container = {\r\n    backgroundColor: \"#ffffff\",\r\n    margin: \"0 auto\",\r\n    padding: \"40px 20px\",\r\n    marginBottom: \"64px\",\r\n    maxWidth: \"600px\",\r\n    borderRadius: \"12px\",\r\n    boxShadow: \"0 4px 20px rgba(0, 0, 0, 0.05)\",\r\n};\r\n\r\nconst header = {\r\n    textAlign: \"center\" as const,\r\n    marginBottom: \"30px\",\r\n};\r\n\r\nconst brandTitle = {\r\n    fontSize: \"28px\",\r\n    letterSpacing: \"2px\",\r\n    fontWeight: \"bold\",\r\n    color: \"#C19B76\",\r\n    margin: \"0\",\r\n};\r\n\r\nconst subTitle = {\r\n    fontSize: \"14px\",\r\n    fontWeight: \"500\",\r\n    color: \"#888888\",\r\n    textTransform: \"uppercase\" as const,\r\n    letterSpacing: \"1px\",\r\n    margin: \"5px 0 0\",\r\n};\r\n\r\nconst contentSection = {\r\n    padding: \"0 10px\",\r\n};\r\n\r\nconst columnStyle = {\r\n    verticalAlign: \"top\",\r\n    width: \"50%\",\r\n};\r\n\r\nconst label = {\r\n    fontSize: \"11px\",\r\n    fontWeight: \"bold\",\r\n    color: \"#b0b0b0\",\r\n    textTransform: \"uppercase\" as const,\r\n    letterSpacing: \"1px\",\r\n    marginBottom: \"8px\",\r\n};\r\n\r\nconst value = {\r\n    fontSize: \"16px\",\r\n    fontWeight: \"600\",\r\n    color: \"#333333\",\r\n    margin: \"0 0 5px\",\r\n};\r\n\r\nconst infoText = {\r\n    fontSize: \"14px\",\r\n    color: \"#555555\",\r\n    margin: \"0\",\r\n    lineHeight: \"1.5\",\r\n};\r\n\r\nconst subInfo = {\r\n    fontSize: \"12px\",\r\n    color: \"#888888\",\r\n};\r\n\r\nconst divider = {\r\n    borderColor: \"#f0f0f0\",\r\n    margin: \"25px 0\",\r\n};\r\n\r\nconst priceValue = {\r\n    fontSize: \"24px\",\r\n    fontWeight: \"bold\",\r\n    color: \"#C19B76\",\r\n    margin: \"0\",\r\n};\r\n\r\nconst statusBadge = {\r\n    backgroundColor: \"#f0fdf4\",\r\n    color: \"#166534\",\r\n    padding: \"4px 12px\",\r\n    borderRadius: \"20px\",\r\n    fontSize: \"12px\",\r\n    fontWeight: \"600\",\r\n    display: \"inline-block\",\r\n};\r\n\r\nconst noteText = {\r\n    fontSize: \"14px\",\r\n    color: \"#666666\",\r\n    fontStyle: \"italic\",\r\n    margin: \"0\",\r\n};\r\n\r\nconst actionSection = {\r\n    marginTop: \"40px\",\r\n    textAlign: \"center\" as const,\r\n};\r\n\r\nconst primaryButton = {\r\n    backgroundColor: \"#C19B76\",\r\n    borderRadius: \"8px\",\r\n    color: \"#fff\",\r\n    fontSize: \"14px\",\r\n    fontWeight: \"bold\",\r\n    textDecoration: \"none\",\r\n    textAlign: \"center\" as const,\r\n    display: \"block\",\r\n    padding: \"12px 20px\",\r\n    width: \"100%\",\r\n};\r\n\r\nconst secondaryButton = {\r\n    backgroundColor: \"#25D366\", // WhatsApp Green\r\n    borderRadius: \"8px\",\r\n    color: \"#fff\",\r\n    fontSize: \"14px\",\r\n    fontWeight: \"bold\",\r\n    textDecoration: \"none\",\r\n    textAlign: \"center\" as const,\r\n    display: \"block\",\r\n    padding: \"12px 20px\",\r\n    width: \"100%\",\r\n};\r\n\r\nconst dashboardLink = {\r\n    fontSize: \"14px\",\r\n    color: \"#C19B76\",\r\n    textDecoration: \"none\",\r\n    fontWeight: \"500\",\r\n    display: \"inline-block\",\r\n};\r\n\r\nconst footer = {\r\n    marginTop: \"40px\",\r\n    textAlign: \"center\" as const,\r\n    borderTop: \"1px solid #f0f0f0\",\r\n    paddingTop: \"30px\",\r\n};\r\n\r\nconst footerText = {\r\n    fontSize: \"12px\",\r\n    color: \"#999999\",\r\n    lineHeight: \"1.6\",\r\n    margin: \"0 0 10px\",\r\n};\r\n\r\nconst footerLink = {\r\n    color: \"#999999\",\r\n    textDecoration: \"underline\",\r\n};\r\n\r\nconst footerSubText = {\r\n    fontSize: \"10px\",\r\n    color: \"#cccccc\",\r\n    margin: \"0\",\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 619, "column": 0}, "map": {"version":3,"sources":["file:///D:/admin-dash/app/actions.ts"],"sourcesContent":["'use server'\r\n\r\nimport { Resend } from 'resend'\r\n\r\nimport { render } from '@react-email/render'\r\nimport { BookingNotificationEmail } from '@/emails/new-booking-email'\r\n\r\nconst resend = new Resend(process.env.RESEND_API_KEY)\r\n\r\ninterface BookingEmailData {\r\n  name: string\r\n  phone_number: string\r\n  package_title: string\r\n  date: string\r\n  guests: number\r\n  adults: number\r\n  children: number\r\n  total_price: number\r\n  status: string\r\n  notes?: string\r\n}\r\n\r\nexport async function sendBookingEmail(booking: BookingEmailData) {\r\n  console.log(\"DEBUG: Starting email process...\")\r\n  console.log(\"DEBUG: Checking API Key:\", process.env.RESEND_API_KEY ? \"EXISTS\" : \"MISSING\")\r\n  console.log(\"DEBUG: Payload prepared\", JSON.stringify(booking, null, 2))\r\n\r\n  if (!process.env.RESEND_API_KEY) {\r\n    console.error(\"DEBUG: RESEND_API_KEY is missing in process.env!\")\r\n    return { success: false, error: \"Missing API Key\" }\r\n  }\r\n\r\n  // 1. Try sending with React Email Template\r\n  try {\r\n    // Manually render (Debug mode)\r\n    console.log(\"DEBUG: Attempting to render React component...\")\r\n    const html = await renderAsync(\r\n      BookingNotificationEmail({\r\n        name: booking.name,\r\n        phone_number: booking.phone_number,\r\n        package_title: booking.package_title,\r\n        date: booking.date,\r\n        guests: booking.guests ?? 1,\r\n        adults: booking.adults ?? 1,\r\n        children: booking.children ?? 0,\r\n        total_price: booking.total_price ?? 0,\r\n        status: booking.status ?? 'Pending',\r\n        notes: booking.notes\r\n      })\r\n    )\r\n    console.log(\"DEBUG: Render successful. Sending email...\")\r\n\r\n    const { data, error } = await resend.emails.send({\r\n      from: 'Marragafay Bookings <onboarding@resend.dev>',\r\n      to: ['marragafay@gmail.com'],\r\n      subject: `New Booking: ${booking.name} - ${booking.package_title}`,\r\n      html: html\r\n    })\r\n\r\n    if (error) {\r\n      console.error('Resend API send failed (after render):', error)\r\n      throw error // Throw to trigger fallback\r\n    }\r\n\r\n    return { success: true, data }\r\n  } catch (reactError) {\r\n    console.error('Failed to RENDER or SEND React email, attempting fallback HTML...', reactError)\r\n    // Fallback logic follows...\r\n    console.error('Failed to send React email, attempting fallback HTML...', reactError)\r\n\r\n    // 2. Fallback to basic HTML if React rendering failed\r\n    try {\r\n      const { data, error } = await resend.emails.send({\r\n        from: 'Marragafay Bookings <onboarding@resend.dev>',\r\n        to: ['marragafay@gmail.com'],\r\n        subject: `New Booking: ${booking.name} - ${booking.package_title} (Fallback)`,\r\n        html: `\r\n          <h1>New Booking Received</h1>\r\n          <p><strong>Customer:</strong> ${booking.name}</p>\r\n          <p><strong>Phone:</strong> ${booking.phone_number}</p>\r\n          <p><strong>Package:</strong> ${booking.package_title}</p>\r\n          <p><strong>Total Price:</strong> ${booking.total_price} MAD</p>\r\n          <p><strong>Status:</strong> ${booking.status}</p>\r\n          <p style=\"color: red; font-size: 12px;\">Note: The fancy email template failed to render. Please check server logs.</p>\r\n        `\r\n      })\r\n\r\n      if (error) {\r\n        console.error('Fallback HTML email also failed:', error)\r\n        return { success: false, error }\r\n      }\r\n\r\n      return { success: true, data }\r\n    } catch (htmlError) {\r\n      console.error('CRITICAL: All email attempts failed:', htmlError)\r\n      return { success: false, error: htmlError }\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAGA;;;;;AAEA,MAAM,SAAS,IAAI,kJAAM,CAAC,QAAQ,GAAG,CAAC,cAAc;AAe7C,eAAe,iBAAiB,OAAyB;IAC9D,QAAQ,GAAG,CAAC;IACZ,QAAQ,GAAG,CAAC,4BAA4B,QAAQ,GAAG,CAAC,cAAc,GAAG,WAAW;IAChF,QAAQ,GAAG,CAAC,2BAA2B,KAAK,SAAS,CAAC,SAAS,MAAM;IAErE,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;QAC/B,QAAQ,KAAK,CAAC;QACd,OAAO;YAAE,SAAS;YAAO,OAAO;QAAkB;IACpD;IAEA,2CAA2C;IAC3C,IAAI;QACF,+BAA+B;QAC/B,QAAQ,GAAG,CAAC;QACZ,MAAM,OAAO,MAAM,YACjB,IAAA,8JAAwB,EAAC;YACvB,MAAM,QAAQ,IAAI;YAClB,cAAc,QAAQ,YAAY;YAClC,eAAe,QAAQ,aAAa;YACpC,MAAM,QAAQ,IAAI;YAClB,QAAQ,QAAQ,MAAM,IAAI;YAC1B,QAAQ,QAAQ,MAAM,IAAI;YAC1B,UAAU,QAAQ,QAAQ,IAAI;YAC9B,aAAa,QAAQ,WAAW,IAAI;YACpC,QAAQ,QAAQ,MAAM,IAAI;YAC1B,OAAO,QAAQ,KAAK;QACtB;QAEF,QAAQ,GAAG,CAAC;QAEZ,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;YAC/C,MAAM;YACN,IAAI;gBAAC;aAAuB;YAC5B,SAAS,CAAC,aAAa,EAAE,QAAQ,IAAI,CAAC,GAAG,EAAE,QAAQ,aAAa,EAAE;YAClE,MAAM;QACR;QAEA,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,0CAA0C;YACxD,MAAM,MAAM,4BAA4B;;QAC1C;QAEA,OAAO;YAAE,SAAS;YAAM;QAAK;IAC/B,EAAE,OAAO,YAAY;QACnB,QAAQ,KAAK,CAAC,qEAAqE;QACnF,4BAA4B;QAC5B,QAAQ,KAAK,CAAC,2DAA2D;QAEzE,sDAAsD;QACtD,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;gBAC/C,MAAM;gBACN,IAAI;oBAAC;iBAAuB;gBAC5B,SAAS,CAAC,aAAa,EAAE,QAAQ,IAAI,CAAC,GAAG,EAAE,QAAQ,aAAa,CAAC,WAAW,CAAC;gBAC7E,MAAM,CAAC;;wCAEyB,EAAE,QAAQ,IAAI,CAAC;qCAClB,EAAE,QAAQ,YAAY,CAAC;uCACrB,EAAE,QAAQ,aAAa,CAAC;2CACpB,EAAE,QAAQ,WAAW,CAAC;sCAC3B,EAAE,QAAQ,MAAM,CAAC;;QAE/C,CAAC;YACH;YAEA,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,oCAAoC;gBAClD,OAAO;oBAAE,SAAS;oBAAO;gBAAM;YACjC;YAEA,OAAO;gBAAE,SAAS;gBAAM;YAAK;QAC/B,EAAE,OAAO,WAAW;YAClB,QAAQ,KAAK,CAAC,wCAAwC;YACtD,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAU;QAC5C;IACF;AACF;;;IA5EsB;;AAAA,+OAAA"}},
    {"offset": {"line": 727, "column": 0}, "map": {"version":3,"sources":["file:///D:/admin-dash/.next-internal/server/app/dashboard/bookings/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {sendBookingEmail as '4081f1dd4aa8ea82e26767a0ae58c488b12e552900'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}